{"ast":null,"code":"/*! @azure/msal-browser v3.0.2 2023-08-18 */\n'use strict';\n\nimport { Constants, UrlString } from '@azure/msal-common';\nimport { FetchClient } from '../network/FetchClient.mjs';\nimport { XhrClient } from '../network/XhrClient.mjs';\nimport { BrowserAuthError } from '../error/BrowserAuthError.mjs';\nimport { BrowserConstants, InteractionType } from './BrowserConstants.mjs';\n\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n/**\n * Utility class for browser specific functions\n */\nclass BrowserUtils {\n  // #region Window Navigation and URL management\n  /**\n   * Clears hash from window url.\n   */\n  static clearHash(contentWindow) {\n    // Office.js sets history.replaceState to null\n    contentWindow.location.hash = Constants.EMPTY_STRING;\n    if (typeof contentWindow.history.replaceState === \"function\") {\n      // Full removes \"#\" from url\n      contentWindow.history.replaceState(null, Constants.EMPTY_STRING, `${contentWindow.location.origin}${contentWindow.location.pathname}${contentWindow.location.search}`);\n    }\n  }\n  /**\n   * Replaces current hash with hash from provided url\n   */\n  static replaceHash(url) {\n    const urlParts = url.split(\"#\");\n    urlParts.shift(); // Remove part before the hash\n    window.location.hash = urlParts.length > 0 ? urlParts.join(\"#\") : Constants.EMPTY_STRING;\n  }\n  /**\n   * Returns boolean of whether the current window is in an iframe or not.\n   */\n  static isInIframe() {\n    return window.parent !== window;\n  }\n  /**\n   * Returns boolean of whether or not the current window is a popup opened by msal\n   */\n  static isInPopup() {\n    return typeof window !== \"undefined\" && !!window.opener && window.opener !== window && typeof window.name === \"string\" && window.name.indexOf(`${BrowserConstants.POPUP_NAME_PREFIX}.`) === 0;\n  }\n  // #endregion\n  /**\n   * Returns current window URL as redirect uri\n   */\n  static getCurrentUri() {\n    return window.location.href.split(\"?\")[0].split(\"#\")[0];\n  }\n  /**\n   * Gets the homepage url for the current window location.\n   */\n  static getHomepage() {\n    const currentUrl = new UrlString(window.location.href);\n    const urlComponents = currentUrl.getUrlComponents();\n    return `${urlComponents.Protocol}//${urlComponents.HostNameAndPort}/`;\n  }\n  /**\n   * Returns best compatible network client object.\n   */\n  static getBrowserNetworkClient() {\n    // @ts-ignore TS2774\n    if (window.fetch && window.Headers) {\n      return new FetchClient();\n    } else {\n      return new XhrClient();\n    }\n  }\n  /**\n   * Throws error if we have completed an auth and are\n   * attempting another auth request inside an iframe.\n   */\n  static blockReloadInHiddenIframes() {\n    const isResponseHash = UrlString.hashContainsKnownProperties(window.location.hash);\n    // return an error if called from the hidden iframe created by the msal js silent calls\n    if (isResponseHash && BrowserUtils.isInIframe()) {\n      throw BrowserAuthError.createBlockReloadInHiddenIframeError();\n    }\n  }\n  /**\n   * Block redirect operations in iframes unless explicitly allowed\n   * @param interactionType Interaction type for the request\n   * @param allowRedirectInIframe Config value to allow redirects when app is inside an iframe\n   */\n  static blockRedirectInIframe(interactionType, allowRedirectInIframe) {\n    const isIframedApp = BrowserUtils.isInIframe();\n    if (interactionType === InteractionType.Redirect && isIframedApp && !allowRedirectInIframe) {\n      // If we are not in top frame, we shouldn't redirect. This is also handled by the service.\n      throw BrowserAuthError.createRedirectInIframeError(isIframedApp);\n    }\n  }\n  /**\n   * Block redirectUri loaded in popup from calling AcquireToken APIs\n   */\n  static blockAcquireTokenInPopups() {\n    // Popups opened by msal popup APIs are given a name that starts with \"msal.\"\n    if (BrowserUtils.isInPopup()) {\n      throw BrowserAuthError.createBlockAcquireTokenInPopupsError();\n    }\n  }\n  /**\n   * Throws error if token requests are made in non-browser environment\n   * @param isBrowserEnvironment Flag indicating if environment is a browser.\n   */\n  static blockNonBrowserEnvironment(isBrowserEnvironment) {\n    if (!isBrowserEnvironment) {\n      throw BrowserAuthError.createNonBrowserEnvironmentError();\n    }\n  }\n  /**\n   * Throws error if initialize hasn't been called\n   * @param initialized\n   */\n  static blockAPICallsBeforeInitialize(initialized) {\n    if (!initialized) {\n      throw BrowserAuthError.createUninitializedPublicClientApplication();\n    }\n  }\n  /**\n   * Returns boolean of whether current browser is an Internet Explorer or Edge browser.\n   */\n  static detectIEOrEdge() {\n    const ua = window.navigator.userAgent;\n    const msie = ua.indexOf(\"MSIE \");\n    const msie11 = ua.indexOf(\"Trident/\");\n    const msedge = ua.indexOf(\"Edge/\");\n    const isIE = msie > 0 || msie11 > 0;\n    const isEdge = msedge > 0;\n    return isIE || isEdge;\n  }\n}\nexport { BrowserUtils };","map":{"version":3,"names":["BrowserUtils","clearHash","contentWindow","location","hash","Constants","EMPTY_STRING","history","replaceState","origin","pathname","search","replaceHash","url","urlParts","split","shift","window","length","join","isInIframe","parent","isInPopup","opener","name","indexOf","BrowserConstants","POPUP_NAME_PREFIX","getCurrentUri","href","getHomepage","currentUrl","UrlString","urlComponents","getUrlComponents","Protocol","HostNameAndPort","getBrowserNetworkClient","fetch","Headers","FetchClient","XhrClient","blockReloadInHiddenIframes","isResponseHash","hashContainsKnownProperties","BrowserAuthError","createBlockReloadInHiddenIframeError","blockRedirectInIframe","interactionType","allowRedirectInIframe","isIframedApp","InteractionType","Redirect","createRedirectInIframeError","blockAcquireTokenInPopups","createBlockAcquireTokenInPopupsError","blockNonBrowserEnvironment","isBrowserEnvironment","createNonBrowserEnvironmentError","blockAPICallsBeforeInitialize","initialized","createUninitializedPublicClientApplication","detectIEOrEdge","ua","navigator","userAgent","msie","msie11","msedge","isIE","isEdge"],"sources":["../../src/utils/BrowserUtils.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}