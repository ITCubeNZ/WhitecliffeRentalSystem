{"ast":null,"code":"/*! @azure/msal-common v14.0.2 2023-08-18 */\n'use strict';\n\nimport { AUTHORITY_METADATA_CONSTANTS } from '../../utils/Constants.mjs';\nimport { TimeUtils } from '../../utils/TimeUtils.mjs';\n\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n/** @internal */\nclass AuthorityMetadataEntity {\n  constructor() {\n    this.expiresAt = TimeUtils.nowSeconds() + AUTHORITY_METADATA_CONSTANTS.REFRESH_TIME_SECONDS;\n  }\n  /**\r\n   * Update the entity with new aliases, preferred_cache and preferred_network values\r\n   * @param metadata\r\n   * @param fromNetwork\r\n   */\n  updateCloudDiscoveryMetadata(metadata, fromNetwork) {\n    this.aliases = metadata.aliases;\n    this.preferred_cache = metadata.preferred_cache;\n    this.preferred_network = metadata.preferred_network;\n    this.aliasesFromNetwork = fromNetwork;\n  }\n  /**\r\n   * Update the entity with new endpoints\r\n   * @param metadata\r\n   * @param fromNetwork\r\n   */\n  updateEndpointMetadata(metadata, fromNetwork) {\n    this.authorization_endpoint = metadata.authorization_endpoint;\n    this.token_endpoint = metadata.token_endpoint;\n    this.end_session_endpoint = metadata.end_session_endpoint;\n    this.issuer = metadata.issuer;\n    this.endpointsFromNetwork = fromNetwork;\n    this.jwks_uri = metadata.jwks_uri;\n  }\n  /**\r\n   * Save the authority that was used to create this cache entry\r\n   * @param authority\r\n   */\n  updateCanonicalAuthority(authority) {\n    this.canonical_authority = authority;\n  }\n  /**\r\n   * Reset the exiresAt value\r\n   */\n  resetExpiresAt() {\n    this.expiresAt = TimeUtils.nowSeconds() + AUTHORITY_METADATA_CONSTANTS.REFRESH_TIME_SECONDS;\n  }\n  /**\r\n   * Returns whether or not the data needs to be refreshed\r\n   */\n  isExpired() {\n    return this.expiresAt <= TimeUtils.nowSeconds();\n  }\n  /**\r\n   * Validates an entity: checks for all expected params\r\n   * @param entity\r\n   */\n  static isAuthorityMetadataEntity(key, entity) {\n    if (!entity) {\n      return false;\n    }\n    return key.indexOf(AUTHORITY_METADATA_CONSTANTS.CACHE_KEY) === 0 && entity.hasOwnProperty(\"aliases\") && entity.hasOwnProperty(\"preferred_cache\") && entity.hasOwnProperty(\"preferred_network\") && entity.hasOwnProperty(\"canonical_authority\") && entity.hasOwnProperty(\"authorization_endpoint\") && entity.hasOwnProperty(\"token_endpoint\") && entity.hasOwnProperty(\"issuer\") && entity.hasOwnProperty(\"aliasesFromNetwork\") && entity.hasOwnProperty(\"endpointsFromNetwork\") && entity.hasOwnProperty(\"expiresAt\") && entity.hasOwnProperty(\"jwks_uri\");\n  }\n}\nexport { AuthorityMetadataEntity };","map":{"version":3,"names":["AuthorityMetadataEntity","constructor","expiresAt","TimeUtils","nowSeconds","AUTHORITY_METADATA_CONSTANTS","REFRESH_TIME_SECONDS","updateCloudDiscoveryMetadata","metadata","fromNetwork","aliases","preferred_cache","preferred_network","aliasesFromNetwork","updateEndpointMetadata","authorization_endpoint","token_endpoint","end_session_endpoint","issuer","endpointsFromNetwork","jwks_uri","updateCanonicalAuthority","authority","canonical_authority","resetExpiresAt","isExpired","isAuthorityMetadataEntity","key","entity","indexOf","CACHE_KEY","hasOwnProperty"],"sources":["../../../src/cache/entities/AuthorityMetadataEntity.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA;;;AAGG;AAOH;MACaA,uBAAuB;EAchCC,YAAA;IACI,IAAI,CAACC,SAAS,GACVC,SAAS,CAACC,UAAU,EAAE,GACtBC,4BAA4B,CAACC,oBAAoB;;EAGzD;;;;AAIG;EACHC,4BAA4BA,CACxBC,QAAgC,EAChCC,WAAoB;IAEpB,IAAI,CAACC,OAAO,GAAGF,QAAQ,CAACE,OAAO;IAC/B,IAAI,CAACC,eAAe,GAAGH,QAAQ,CAACG,eAAe;IAC/C,IAAI,CAACC,iBAAiB,GAAGJ,QAAQ,CAACI,iBAAiB;IACnD,IAAI,CAACC,kBAAkB,GAAGJ,WAAW;;EAGzC;;;;AAIG;EACHK,sBAAsBA,CAClBN,QAA8B,EAC9BC,WAAoB;IAEpB,IAAI,CAACM,sBAAsB,GAAGP,QAAQ,CAACO,sBAAsB;IAC7D,IAAI,CAACC,cAAc,GAAGR,QAAQ,CAACQ,cAAc;IAC7C,IAAI,CAACC,oBAAoB,GAAGT,QAAQ,CAACS,oBAAoB;IACzD,IAAI,CAACC,MAAM,GAAGV,QAAQ,CAACU,MAAM;IAC7B,IAAI,CAACC,oBAAoB,GAAGV,WAAW;IACvC,IAAI,CAACW,QAAQ,GAAGZ,QAAQ,CAACY,QAAQ;;EAGrC;;;AAGG;EACHC,wBAAwBA,CAACC,SAAiB;IACtC,IAAI,CAACC,mBAAmB,GAAGD,SAAS;;EAGxC;;AAEG;EACHE,cAAcA,CAAA;IACV,IAAI,CAACtB,SAAS,GACVC,SAAS,CAACC,UAAU,EAAE,GACtBC,4BAA4B,CAACC,oBAAoB;;EAGzD;;AAEG;EACHmB,SAASA,CAAA;IACL,OAAO,IAAI,CAACvB,SAAS,IAAIC,SAAS,CAACC,UAAU,EAAE;;EAGnD;;;AAGG;EACH,OAAOsB,yBAAyBA,CAACC,GAAW,EAAEC,MAAc;IACxD,IAAI,CAACA,MAAM,EAAE;MACT,OAAO,KAAK;IACf;IAED,OACID,GAAG,CAACE,OAAO,CAACxB,4BAA4B,CAACyB,SAAS,CAAC,KAAK,CAAC,IACzDF,MAAM,CAACG,cAAc,CAAC,SAAS,CAAC,IAChCH,MAAM,CAACG,cAAc,CAAC,iBAAiB,CAAC,IACxCH,MAAM,CAACG,cAAc,CAAC,mBAAmB,CAAC,IAC1CH,MAAM,CAACG,cAAc,CAAC,qBAAqB,CAAC,IAC5CH,MAAM,CAACG,cAAc,CAAC,wBAAwB,CAAC,IAC/CH,MAAM,CAACG,cAAc,CAAC,gBAAgB,CAAC,IACvCH,MAAM,CAACG,cAAc,CAAC,QAAQ,CAAC,IAC/BH,MAAM,CAACG,cAAc,CAAC,oBAAoB,CAAC,IAC3CH,MAAM,CAACG,cAAc,CAAC,sBAAsB,CAAC,IAC7CH,MAAM,CAACG,cAAc,CAAC,WAAW,CAAC,IAClCH,MAAM,CAACG,cAAc,CAAC,UAAU,CAAC;;AAG5C"},"metadata":{},"sourceType":"module","externalDependencies":[]}